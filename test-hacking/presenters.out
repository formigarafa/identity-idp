
Randomized with seed 59055

ImageUploadResponsePresenter
  #status
    failure
      returns 400 bad request
    success
      returns ok
    limit error
      returns 429 too many requests
  #success?
    failure
      returns false
    success
      returns true
  #remaining_attempts
    returns remaining attempts
  #errors
    failure
      returns formatted errors
    success
      returns empty array
  #as_json
    error
      returns hash of properties
      hard fail
        returns hash of properties
      no remaining attempts
        returns hash of properties
    with form response as attention with barcode
      returns hash of properties
    throttled
      returns hash of properties
    success
      returns hash of properties

ConfirmDeleteEmailPresenter
  #confirm_delete_message
    supplies a message for confirm delete page

TwoFactorAuthentication::PersonalKeySelectionPresenter
  #type
    returns personal_key

Idv::CancellationsPresenter
  #exit_description
    returns exit description contents
    with associated sp
      returns exit description contents
  #exit_heading
    returns exit heading
    with associated sp
      returns exit heading
  #exit_action_text
    returns exit action text
    with associated sp
      returns exit action text

TwoFactorLoginOptionsPresenter
  supplies a title
  supplies a heading
  supplies a recovery options link when feature toggle is on
  supplies a cancel link when the token is valid
  supplies a reset link when the token is not valid
  with multiple webauthn configurations
    has only one webauthn selection presenter
  #first_enabled_option_index
    returns first index
    enabled options
      returns first enabled index
    disabled options
      returns first enabled index
  #cancel_link
    reauthentication user session context
      is expected to eq "/account"
    default user session context
      is expected to eq "/sign_out"

SetupPresenter
  shows correct value for remember device
    shows true for cookie: true, default value: true
    shows false for cookie: nil, default value: false
    shows true for cookie: true, default value: false
    shows false for cookie: nil, default value: true

TwoFactorAuthentication::PhoneSelectionPresenter
  #mfa_configuration
    returns an empty string when user has not configured this authenticator
    includes a note to select an additional mfa method on first setup
    returns an # added when user has configured this authenticator
    does not include a note to select an additional mfa on additional setup
  #disabled?
    is expected to eq false
    all phone vendor outage
      is expected to eq true
  #info
    when a user does not have a phone configuration (first time)
      does not include a masked number
      includes a note about choosing voice or sms

PivCacErrorPresenter
  #heading
    is expected to eq "We cannot detect a certificate on your PIV/CAC card"
  #description
    is expected to eq "Please make sure your PIV/CAC is connected and . If this problem continues, contact your agency administrator."
  #error
    reflects the form
  #title
    is expected to eq "We cannot detect a certificate on your PIV/CAC card"

TwoFactorAuthCode::BackupCodePresenter
  #help_text
    returns blank
  #fallback_question
    returns the fallback question
  #cancel_link
    returns a different link for cancellation if reauthn is true
    returns the link for cancellation

TwoFactorAuthentication::WebauthnPlatformSelectionPresenter
  #html_class
    returns display-none
  #mfa_configruation
    returns an empty string when user has not configured this authenticator
    returns an # added when user has configured this authenticator
  #type
    returns webauthn_platform

OpenidConnectCertsPresenter
  #certs
    renders the server public key as a JWK set

TwoFactorAuthCode::WebauthnAuthenticationPresenter
  handles multiple locales
  #cancel_link
    not reauthn
      returns the sign out path
    reauthn
      returns the account path
  #help_text
    supplies no help text
  #fallback_question
    supplies a fallback_question
  #authenticate_button_text
    with a roaming authenticator
      renders the roaming authenticator button text
    with a platform authenticator
      renders the platform authenticator button text
  #multiple_factors_enabled?
    with multiple factors enabled in user policy
      returns true
    with multiple factors not enabled for user policy
      returns false
  #header
    with a roaming authenticator
      renders the roaming authenticator header
    with a platform authenticator
      renders the platform authenticator header
  #verified_info_text
    with a platform authenticator
      renders the platform authenticator text
    with a roaming authenticator
      renders the roaming authenticator text
  #verified_header
    with a roaming authenticator
      renders the roaming authenticator header
    with a platform authenticator
      renders the platform authenticator header
  #link_text
    with multiple phishing-resistant methods
      supplies link text
    with only one phishing-resistant method do
      supplies no link text
  #webauthn_help
    with phishing-resistant not required
      displays the help text
    with phishing-resistant required
      the user only has a security key enabled
        returns the help text for just the security key
      the user has a security key and PIV enabled
        returns the help text for the security key or PIV
    with a platform authenticator
      returns the help text for a platform authenticator

NavigationPresenter
  #navigation_items
    personal key
      for a proofed user with deactivated profile due to password reset
        does not have a link to reset personal key
      for a user that does not have a personal key
        does not link to reset personal key
      for a user with a personal key
        has a link to reset personal key

RiscConfigurationPresenter
  #configuration
    includes information about the RISC integration

CancellationPresenter
  #go_back_link
    with a referer header
      returns the path
    without a referer header
      returns the sign_up_path
    with a referer header for a different domain
      returns the sign_up_path
    with a referer header with query params
      returns the path with the query params
    with a referer header with a javascript scheme
      returns the sign_up_path

PivCacAuthenticationSetupPresenter
  #description
    is expected to eq "We’ll ask you to present your PIV/CAC card <strong>each time you sign in</strong> as part of two-fac... “Add PIV/CAC” your browser will prompt you for your PIV/CAC PIN and have you select a certificate."
  #heading
    is expected to eq "Use your PIV/CAC card to secure your account"
  #title
    is expected to eq "Use your PIV/CAC card to secure your account"

TwoFactorAuthCode::AuthenticatorDeliveryPresenter
  handles multiple locales
  #fallback_question
    supplies a fallback_question
  #header
    supplies a header

UtcTimePresenter
  #to_s
    returns the formatted timestamp in a string

TwoFactorAuthCode::PhoneDeliveryPresenter
  is a subclass of GenericDeliveryPresenter
  #phone_number_message
    specifies when the code will expire
  #cancel_link
    returns the sign out path during authentication
    returns the account path during reauthn
    returns the account path during phone change confirmation

WebauthnSetupPresenter
  #button_text
    is expected to eq "Continue"
  #intro_link
    is expected to include "Learn more about face or touch unlock."
    is expected to include "https://www.login.gov/help/get-started/authentication-options/"
  #intro_html
    is expected to eq "<p>Add a security key that meets the FIDO standard as your authentication method. You can add as many security keys as you want. To get started, first give your security key a nickname.</p>"
  #image_path
    is expected to eq "security-key.svg"
  with platform_authenticator
    #heading
      is expected to eq "Use your device"
    #button_text
      is expected to eq "Continue"
    #setup_heading
      is expected to eq "Use Touch or Face Unlock to access your account."
    #image_path
      is expected to eq "platform-authenticator.svg"
    #nickname_label
      is expected to eq "Device nickname"
  #setup_heading
    is expected to eq "Connect your security key"
  #heading
    is expected to eq "Add your security key"
  #nickname_label
    is expected to eq "Security key nickname"

TwoFactorAuthentication::PivCacSelectionPresenter
  #mfa_configruation
    returns an empty string when user has not configured this authenticator
    returns an # added when user has configured this authenticator
  #type
    returns piv_cac

OpenidConnectConfigurationPresenter
  #configuration
    includes information about the OpenID Connect integration

TwoFactorAuthCode::PersonalKeyPresenter
  #help_text
    returns blank
  #fallback_question
    returns the fallback question

FullySignedInModalPresenter
  #sr_message
    returns the fully signed in message for screen readers
  #sign_out
    uses the fully signed in localization
  #continue
    uses the fully signed in localization
  #message
    returns the fully signed in message

AccountReset::PendingPresenter
  #account_reset_request
    returns the account reset request
  #time_remaining_until_granted
    when the remaining time is less than 1 second
      returns less than 1 second
    when the remaining time is greater than 1 hour
      returns its description in hours and minutes
    when the remaining time is less than 2 minutes
      returns its description in 1 minute and seconds
    when the remaining time is less than 1 minute
      returns its description in minutes and seconds
    when the remaining time is greater than 1 minute
      returns its description in minutes and seconds
    when the remaining time is less than 2 hours
      returns its description in 1 hour and minutes

TwoFactorAuthentication::VoiceSelectionPresenter
  #type
    when a user has more than one phone configuration
      returns voice:id
    when a user has only one phone configuration
      returns voice
  #info
    when a user has a phone configuration
      includes the masked the number
  #disabled?
    is expected to eq false
    voice vendor outage
      is expected to eq true

OpenidConnectUserInfoPresenter
  #user_info
    has basic attributes
    when a piv/cac was used as second factor
      when the identity has no piv/cac associated
        when the scope includes all attributes
          returns no x509 attributes
      when the identity has piv/cac associated
        when the scope includes all attributes
          renders values as simple strings as json
          returns x509 attributes
    when there is decrypted ial2 session data in redis
      when the identity only has ial1 access
        does not return ial2 attributes
      when the identity has ial2 access
        when the scope only includes minimal attributes
          returns attributes allowed by the scope
        verified_at
          when the service provider has ial2 access
            provides verified_at
          when the service provider has ial1 access
            does not provide verified_at
        when the scope includes all attributes
          renders values as simple strings as json
          returns ial2 attributes

TwoFactorAuthCode::MaxAttemptsReachedPresenter
  #decorated_user
    is expected to eq #<InstanceDouble(UserDecorator) (anonymous)>
  #locked_reason
    returns locked reason
    with unsupported type
      raises error
  #type
    is expected to eq "otp_requests"

TwoFactorAuthentication::SmsSelectionPresenter
  #type
    when a user has more than one phone configuration
      returns sms:id
    when a user has only one phone configuration
      returns sms
  #disabled?
    is expected to eq false
    sms vendor outage
      is expected to eq true
  #info
    when a user has a phone configuration
      includes the masked the number

AccountShowPresenter
  #totp_content
    user does not have an authenticator app enabled
      returns localization for auth_app_disabled
    user has enabled an authenticator app
      returns localization for auth_app_enabled
  #pii
    birthday is formatted as an international date
      parses the birthday
    birthday is formatted as an american date
      parses the birthday
  #header_personalization
    AccountShowPresenter instance has decrypted_pii
      returns the user's first name
    AccountShowPresenter instance does not have decrypted_pii
      returns the email the user used to sign in last
  #backup_codes_generated_at
    returns nil if there are not backup codes
    returns the created_at date of the oldest backup code
  #personal_key_generated_at
    the user has no encrypted_recovery_code_digest_generated_at and is not proofed
      returns nil
    the user does not have a encrypted_recovery_code_digest_generated_at but is proofed
      returns the date the user was proofed
    the user has a encrypted_recovery_code_digest_generated_at date
      returns the date in the digest

CompletionsPresenter
  #heading
    the sp has requested new attributes
      renders the new attributes message
    ial2 sign in
      renders the ial2 message
      renders the ial2 consent message if consent expired
        renders the expired consent message
    consent has expired since the last sign in with ial1
      renders the expired consent message
    the user is signing into an SP for the first time
      renders the new sp message
    first time the user signs into any SP
      renders the first time sign in message
  #pii
    ial1
      with email and all_emails requested
        only displays all_emails
      with a subset of attributes requested
        properly scopes and resolve attributes
      with all attributes requested
        properly scopes and resolve attributes
    ial2
      with all attributes requested
        properly scopes and resolve attributes
      with a subset of attributes requested
        properly scopes and resolve attributes
  #image_name
    ial2 sign in
      renders the ial2 image
    ial1 sign in
      renders the ial1 image
  #intro
    ial2
      consent has expired since the last sign in
        renders the expired IAL2 consent intro message
      when consent has not expired
        renders the standard intro message
    ial1
      consent has expired since the last sign in
        renders the expired IAL1 consent intro message
      when consent has not expired
        renders the standard intro message

TwoFactorAuthCode::PivCacAuthenticationPresenter
  #piv_cac_capture_text
    is expected to eq "Present PIV/CAC card"
  #cancel_link
    not reauthn
      returns the sign out path
    reauthn
      returns the account path
  #link_text
    with only one phishing-resistant method do
      supplies no link text
    with multiple phishing-resistant methods
      supplies link text
  help_text
    supplies no help text
  #fallback_question
    when the user cannot switch to a different method
      returns an empty string
    when the user can switch to a different method
      returns a question about switching methods
  #header
    is expected to eq "Present your PIV/CAC"
  #piv_cac_help
    returns help text
    with PIV/CAC only requested
      with a user who has a PIV and security key
        returns the PIV only help text
      with a user who only has a PIV
        returns the PIV only help text
    with phishing-resistant requested
      with a user who only has a PIV
        returns the PIV only help text
      with a user who has a PIV and security key
        returns the PIV or phishing-resistant help text

SamlRequestPresenter
  #requested_attributes
    with no requested context and IAL1 SP
      returns permitted attribute_bundle
    IAL1 and bundle contains invalid attributes and IAL2 attributes
      only returns :email
    IAL2 and bundle contains multiple address attributes
      consolidates address attributes into one :address attribute
    IAL2 and bundle contains invalid attributes
      only returns valid attributes named per the OpenId Connect spec
    with no requested context and IAL2 SP
      returns SP attribute_bundle

TwoFactorAuthentication::AuthAppSelectionPresenter
  #mfa_configruation
    return an # added when user has configured this authenticator
    return an empty string when user has not configured this authenticator
  #type
    returns auth_app

TwoFactorAuthCode::GenericDeliveryPresenter
  is an abstract presenter with methods that should be implemented

MfaConfirmationPresenter
  #heading?
    supplies a message
  #info?
    supplies a message
  #button?
    supplies a message

Idv::InPerson::ReadyToVerifyPresenter
  #selected_location_details
    returns a hash of location details associated with the enrollment
    with blank selected_location_details
      returns nil
  #formatted_due_date
    returns a formatted due date
    there is no enrollment_established_at
      returns formatted due date when no enrollment_established_at
  #barcode_image_url
    is expected to be nil
    with barcode url
      returns barcode url
  #needs_proof_of_address?
    with current address not matching id
      is expected to eq true
    with current address matching id
      is expected to eq false
  #selected_location_hours
    returns localized location hours for weekdays and weekends by prefix
    with Spanish locale
      returns localized location hours for weekdays and weekends by prefix
  #days_remaining
    4 days until due date
      returns 3 days
  #sp_name
    returns friendly service provider name

EasternTimePresenter
  #to_s
    returns the formatted timestamp in a string

Idv::InPerson::VerificationResultsEmailPresenter
  #show_cta?
    with service provider
      without homepage_url
        is expected to eq false
      with homepage_url
        is expected to eq true
    without service provider
      is expected to eq true
  #service_provider_or_app_name
    without service provider
      returns app name
    with service provider
      returns friendly name of service provider
  #formatted_verified_date
    returns a formatted verified date
  #service_provider_homepage_url
    with service provider
      with homepage_url
        returns homepage url
      without homepage_url
        returns root url
    without service provider
      returns nil
  #sign_in_url
    with service provider
      with homepage_url
        returns homepage url
      without homepage_url
        returns root url
    without service provider
      returns root url
  #service_provider
    returns service provider associated with enrollment
  #location_name
    returns the enrollment location name

TwoFactorOptionsPresenter
  #options
    supplies all the options for a user
    when a phishing-resistant only SP is being used
      only displays phishing-resistant MFA methods
    when platform_auth_set_up_enabled is enabled
      supplies all the options except webauthn
    when hide_phone_mfa_signup is enabled
      supplies all the options except phone

TwoFactorAuthentication::WebauthnSelectionPresenter
  #type
    returns webauthn
  #html_class
    returns display-none
  #mfa_configruation
    returns an # added when user has configured this authenticator
    returns an empty string when user has not configured this authenticator

TwoFactorAuthentication::SelectionPresenter
  #disabled?
    is expected to eq false
  #info
    with configuration
      raises with missing translation
    with no configuration
      raises with missing translation
  #label
    with configuration
      raises with missing translation
    with no configuration
      raises with missing translation

Idv::GpoPresenter
  #title
    a letter has been sent
      provides text to resend
    a letter has not been sent
      provides text to send
  #button
    a letter has not been sent
      provides text to send
    a letter has been sent
      provides text to resend
  #fallback_back_path
    when the user has a pending profile
      returns the verify account path
    when the user does not have a pending profile
      returns the idv phone path

PartiallySignedInModalPresenter
  #message
    returns the partially signed in message
  #continue
    uses the partially signed in localization
  #sr_message
    returns the partially signed in message for screen readers
  #sign_out
    uses the partially signed in localization

AdditionalMfaRequiredPresenter
  #skip
    when its after enforcement date
      supplies proper skip text
    when its before enforcement date
      supplies proper skip text
  #title
    when its after enforcement date
      supplies proper title
    when its before enforcement date
      supplies proper title
  #cant_skip_anymore?
    when its after enforcement date
      when user doesnt have attribute set
        should return false
      when users have attribute set
        should return true
    when its before enforcement date
      should return false
  #info
    when its after enforcement date
      supplies proper info
    when its before enforcement date
      supplies proper info

Top 10 slowest examples (1.89 seconds, 9.2% of total time):
  ImageUploadResponsePresenter#status failure returns 400 bad request
    0.26201 seconds ./spec/presenters/image_upload_response_presenter_spec.rb:83
  OpenidConnectUserInfoPresenter#user_info has basic attributes
    0.25834 seconds ./spec/presenters/openid_connect_user_info_presenter_spec.rb:28
  OpenidConnectUserInfoPresenter#user_info when there is decrypted ial2 session data in redis when the identity has ial2 access when the scope includes all attributes renders values as simple strings as json
    0.18892 seconds ./spec/presenters/openid_connect_user_info_presenter_spec.rb:130
  TwoFactorLoginOptionsPresenter with multiple webauthn configurations has only one webauthn selection presenter
    0.17624 seconds ./spec/presenters/two_factor_login_options_presenter_spec.rb:87
  CompletionsPresenter#heading the user is signing into an SP for the first time renders the new sp message
    0.1759 seconds ./spec/presenters/completions_presenter_spec.rb:143
  OpenidConnectUserInfoPresenter#user_info when there is decrypted ial2 session data in redis when the identity has ial2 access when the scope includes all attributes returns ial2 attributes
    0.17202 seconds ./spec/presenters/openid_connect_user_info_presenter_spec.rb:111
  OpenidConnectUserInfoPresenter#user_info when there is decrypted ial2 session data in redis when the identity has ial2 access verified_at when the service provider has ial1 access does not provide verified_at
    0.16915 seconds ./spec/presenters/openid_connect_user_info_presenter_spec.rb:162
  CompletionsPresenter#intro ial2 consent has expired since the last sign in renders the expired IAL2 consent intro message
    0.16414 seconds ./spec/presenters/completions_presenter_spec.rb:217
  Idv::InPerson::ReadyToVerifyPresenter#barcode_image_url is expected to be nil
    0.16209 seconds ./spec/presenters/idv/in_person/ready_to_verify_presenter_spec.rb:145
  Idv::InPerson::VerificationResultsEmailPresenter#formatted_verified_date returns a formatted verified date
    0.16171 seconds ./spec/presenters/idv/in_person/verification_results_email_presenter_spec.rb:31

Top 10 slowest example groups:
  OpenidConnectUserInfoPresenter
    0.15572 seconds average (1.56 seconds / 10 examples) ./spec/presenters/openid_connect_user_info_presenter_spec.rb:3
  ConfirmDeleteEmailPresenter
    0.13125 seconds average (0.13125 seconds / 1 example) ./spec/presenters/confirm_delete_email_presenter_spec.rb:3
  Idv::InPerson::VerificationResultsEmailPresenter
    0.11434 seconds average (1.6 seconds / 14 examples) ./spec/presenters/idv/in_person/verification_results_email_presenter_spec.rb:3
  Idv::InPerson::ReadyToVerifyPresenter
    0.11189 seconds average (1.34 seconds / 12 examples) ./spec/presenters/idv/in_person/ready_to_verify_presenter_spec.rb:3
  CompletionsPresenter
    0.11134 seconds average (1.89 seconds / 17 examples) ./spec/presenters/completions_presenter_spec.rb:3
  NavigationPresenter
    0.10531 seconds average (0.31594 seconds / 3 examples) ./spec/presenters/navigation_presenter_spec.rb:3
  Idv::GpoPresenter
    0.09141 seconds average (0.54847 seconds / 6 examples) ./spec/presenters/idv/gpo_presenter_spec.rb:3
  PivCacAuthenticationSetupPresenter
    0.08466 seconds average (0.25399 seconds / 3 examples) ./spec/presenters/piv_cac_authentication_setup_presenter_spec.rb:3
  TwoFactorAuthentication::PhoneSelectionPresenter
    0.08229 seconds average (0.6583 seconds / 8 examples) ./spec/presenters/two_factor_authentication/phone_selection_presenter_spec.rb:3
  SetupPresenter
    0.08196 seconds average (0.32784 seconds / 4 examples) ./spec/presenters/setup_presenter_spec.rb:3

Finished in 20.64 seconds (files took 0.68585 seconds to load)
267 examples, 0 failures

Randomized with seed 59055

